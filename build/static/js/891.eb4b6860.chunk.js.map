{"version":3,"file":"static/js/891.eb4b6860.chunk.js","mappings":"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","sources":["components/PersonalReading/sideComponents/TextEditor/TextEditor.tsx","components/PersonalReading/sideComponents/PageRendered/PageRendered.js","webpack://label_front/./src/components/PersonalReading/sideComponents/HighlightList/HighlightList.module.css?0f21","webpack://label_front/./src/components/PersonalReading/sideComponents/SearchBar/SearchBar.module.css?f79b","components/PersonalReading/sideComponents/SearchBar/SearchBar.js","components/PersonalReading/sideComponents/HighlightList/HighlightBadge/HighlightBadge.js","components/PersonalReading/sideComponents/HighlightList/HighlightList.js","webpack://label_front/./src/components/PersonalReading/sideComponents/SideBar/SideBar.module.css?ec18","components/PersonalReading/sideComponents/ShowAndHideSwitch/ShowAndHideSwitch.js","components/PersonalReading/sideComponents/SideBar/SideBar.js","components/PersonalReading/sideFunction/sideFunction.js","components/PersonalReading/PersonalReading.js"],"sourcesContent":["import { editorViewOptionsCtx } from '@milkdown/core';\nimport { defaultValueCtx, Editor, rootCtx, JSONRecord } from '@milkdown/core';\nimport { listener, listenerCtx } from '@milkdown/plugin-listener';\nimport { prism } from '@milkdown/plugin-prism';\nimport { tooltip } from '@milkdown/plugin-tooltip';\nimport { ReactEditor, useEditor, useNodeCtx } from '@milkdown/react';\nimport { nord } from '@milkdown/theme-nord';\nimport { FC, ReactNode, useEffect } from 'react';\nimport { block, blockPlugin } from '@milkdown/plugin-block';\nimport { math } from '@milkdown/plugin-math';\nimport { menu, menuPlugin } from '@milkdown/plugin-menu';\nimport { gfm } from '@milkdown/preset-gfm';\nimport { history } from '@milkdown/plugin-history'\nimport io from 'socket.io-client';\nimport React from 'react';\nimport './TextEditor.css';\nimport axios from \"axios\";\n\nconst url:string = 'https://tradingstudy.shop:443';\nlet socket:any;\n\nlet timerId:NodeJS.Timeout\nexport class WrapperTextEditor extends React.Component<{readOnly:number, markdownValue: JSONRecord, commitIdx: number, userIdx: string, pdfIdx: string}, { fp: any, flag: boolean }> {\n    constructor(props: any) {\n        super(props);\n        socket = io(url, {\n            transports: [\"websocket\"],\n            query: {\n                \"userId\": String(this.props.userIdx),\n                \"pdfId\": String(this.props.pdfIdx)\n            },\n        });\n        \n        this.state = {fp: {}, flag: false};\n        socket.on('connect',() => {\n            socket.once('updateEditorOnce', (value: any) => {\n                this.setState({\n                    fp: value,\n                    flag: true,\n                })\n            })\n        })\n        \n        // if (this.props.commitIdx !== -1) {\n        //     socket.disconnect();\n        // }\n    }\n\n    render() {\n        return (\n            <div>\n                {this.state.flag && <TextEditor readOnly={this.props.readOnly} value={this.state.fp} markdownValue={this.props.markdownValue} commitIdx={this.props.commitIdx} userIdx={this.props.userIdx} pdfIdx={this.props.pdfIdx}/>}\n            </div>\n        )\n    };\n\n    componentWillUnmount() {\n        if (socket != null && socket.connected === true) {\n            // console.log('disconnect');\n            socket.disconnect();\n        }\n    }\n}\n\n/* solution 2 */\nfunction updateEditor(userID : string, pdfID : string, value : any) {\n    timerId = setTimeout(() => {\n        socket.emit(\"updateEditor\", {id: userID, pdfId: pdfID, text: value}, clearTimeout(timerId));\n    }, 700)\n}\n\nasync function updateOrClearEditor(userID: string, pdfID : string, jsonOutput : any) {\n    if (timerId) {\n        clearTimeout(timerId);\n        updateEditor(userID, pdfID, jsonOutput)\n    } else {\n        updateEditor(userID, pdfID, jsonOutput)\n    }\n}\n\nasync function imageHandler(imageSrc : any, userID : string) {\n    const { preSignedUrl, fileName } : any = await getPresignedUrl(userID);\n    const imageFile = await imageSrcToFile(imageSrc, fileName);\n    const imageUrl = `https://label-editor.s3.ap-northeast-2.amazonaws.com/${fileName}`;\n\n    await uploadImageToS3(preSignedUrl.signedUrlPut, imageFile);\n    return imageUrl\n}\n\nasync function getPresignedUrl(userID : string) {\n    try {\n        const randomString = Math.random().toString(36).substring(2, 11);\n        const fileName = `${userID}_${randomString}.png`;\n        const response = await axios.post(\"https://tradingstudy.shop:443/users/sign\", {\n            fileName\n        });\n        return {preSignedUrl: response.data, fileName};\n    } catch (err) {\n        console.log(err);\n    }\n}\n\nasync function imageSrcToFile(imageSrc : any, fileName : any) {\n    var arr = imageSrc.split(','), mime = arr[0].match(/:(.*?);/)[1],\n    bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);\n    while(n--){\n        u8arr[n] = bstr.charCodeAt(n);\n    }\n    return new File([u8arr], fileName, {type:mime});\n}\n\nasync function uploadImageToS3(preSignedUrl : any, imageFile : any) {\n    const response = await fetch(preSignedUrl, {\n        method: 'PUT',\n        body: imageFile,\n        headers: {\n        'x-amz-acl':'public-read',\n        'Content-Type': 'image/png',\n        },\n    })\n}\n\nexport const TextEditor: FC<{ readOnly: number, value: JSONRecord, markdownValue: JSONRecord, commitIdx: number, userIdx: string, pdfIdx: string }> = ({ readOnly, value, markdownValue, commitIdx, userIdx, pdfIdx }) => {\n    // let readonly = false;\n    // const editable = () => !readonly;\n    const nullable:null = null;\n    const { editor, loading, getInstance } = useEditor((root, renderReact) => {\n                \n                if (Object.keys(markdownValue).length !== 0){\n                    console.log('heloooooooooo', markdownValue);\n                    \n                    if (readOnly === -1) {\n                        updateOrClearEditor(userIdx, pdfIdx, markdownValue);        \n                    }\n                }\n                \n                const editor = Editor.make()\n                    .config((ctx) => {\n                        ctx.set(rootCtx, root);\n                        // 처음 생성된 editor라면 빈 화면 생성\n                        // 그게 아니라면 JSON형식으로 DB에서 불러들임\n                        if (commitIdx === -1 && value.length !== 0) {\n                            // console.log('-------1. 롤백 x', value);\n                            ctx.set(defaultValueCtx, {\n                                type: \"json\",\n                                value: value,\n                            });    \n                        } else if (commitIdx === -1 && Object.keys(value).length === 0) {\n                            // console.log('-------2. 롤백 x + 아무런 value가 없을 때', value);\n                            ctx.set(defaultValueCtx, '');  \n                        } else {\n                            // console.log('-------3. 롤백', markdownValue);\n                            ctx.set(defaultValueCtx, {\n                                type: 'json',\n                                value: markdownValue,\n                            })\n                            // console.log(markdownValue);\n                        }\n                        \n                        ctx.get(listenerCtx).updated(async (ctx, doc, prevDoc) => {\n                            let jsonOutput = doc.toJSON();\n                            console.log('jsonOutput: ',jsonOutput);\n                            let arrOutput = jsonOutput.content;\n                            for (let i = 0; i < arrOutput.length; i++) {\n                                // html상 dom을 바꿔도 doc은 바뀌지 않는다. 다른것으로 생각해야함.\n                                // JSON 형식으로 DB와 주고받는 것으로 수정\n                                // 한 블록안에 여러개의 이미지를 넣는 경우 처리\n                                if (arrOutput[i].content) {\n                                    for (let j = 0; j < arrOutput[i].content.length; j++) {\n                                        let contentInDoc = arrOutput[i].content[j]\n                                        let contentInDocType = contentInDoc['type']\n                                        let contentAttr = contentInDoc['attrs']\n                                        console.log('contentAttr',contentAttr, contentInDoc)\n                                        if (contentAttr !== undefined && !contentAttr['alt'] && contentInDocType === 'image') {\n                                            contentAttr['alt'] = 'lable_image'\n                                            console.log('it is not stored yet!!')\n                                            let imageSrc = contentAttr['src']\n                                            /* 이미지를 s3 서버에 전달 */\n                                            /* 이미지 url 반환받아서 doc JSON 변경 */\n                                            const imageUrl = await imageHandler(imageSrc, userIdx);\n                                            console.log('imagesrc:', imageUrl)\n                                            contentAttr['src'] = imageUrl;\n                                            // console.log('changed val:',imageSrc);\n                                        }\n                                        else {\n                                            if (contentInDocType === 'image')\n                                            console.log('it is alread loaded!!');\n                                        }\n                                        console.log(arrOutput[i], contentInDoc, contentInDocType);\n                                    }\n                                }\n                            }\n                            \n                            console.log(jsonOutput);\n                            await updateOrClearEditor(userIdx, pdfIdx, jsonOutput);\n                            \n                            return value;\n                        });\n                    })\n                    .use(readOnly === -1 ? block : tooltip)\n                    .use(menu)\n                    .use(nord)\n                    .use(history)\n                    .use(gfm)\n                    .use(math)\n                    .use(prism)\n                    .use(listener)\n\n                    return editor\n        }, [commitIdx, markdownValue])\n           \n    useEffect(() => {\n        document.querySelector('.ProseMirror.editor')?.setAttribute('ondrop', 'drop_handler(event)');\n        document.querySelector('.ProseMirror.editor')?.setAttribute('ondragover', 'dragover_handler(event)');\n        \n        let height = document.querySelector('.PersonalReading__mainPage')?.clientHeight;\n        if (height != null) {\n            document.querySelector('.milkdown')?.setAttribute('style', `height: ${height - 240}px`);    \n        }\n        \n        if (readOnly === 1) {            \n            document.querySelector('.ProseMirror.editor')?.setAttribute('contenteditable', 'false');\n            // document.querySelectorAll('.editor > *')?.forEach((element) => {\n            //     console.log(element);\n            //     element.setAttribute('style', 'cursor: default !important');\n            // })\n        }\n        \n        document.querySelector('.editor')?.setAttribute('style', 'overflow: scroll !important');\n    });\n    \n    useEffect(() => {\n        return () => {\n            \n        }\n    }, [])\n    \n    return <ReactEditor editor={editor} />\n};","import { useEffect } from \"react\";\nimport \"./PageRendered.css\";\n\nfunction PageRendered(props) {\n    return (\n        <div dangerouslySetInnerHTML={{ __html: props.html }}></div>\n    );\n}\n\nexport default PageRendered;\n","// extracted by mini-css-extract-plugin\nexport default {\"wrap\":\"HighlightList_wrap__5AIyL\",\"container\":\"HighlightList_container__aHWyH\",\"title\":\"HighlightList_title__hmW+d\",\"pageNumberInfo\":\"HighlightList_pageNumberInfo__WUuxT\",\"pageNumberInput\":\"HighlightList_pageNumberInput__XFaQe\",\"highlightInfo\":\"HighlightList_highlightInfo__StQzz\",\"pageNumber\":\"HighlightList_pageNumber__Moyj3\",\"highlightCard\":\"HighlightList_highlightCard__-rmff\",\"highlightColor\":\"HighlightList_highlightColor__CmWNn\",\"highlightedText\":\"HighlightList_highlightedText__4dHKZ\",\"clearHighlight\":\"HighlightList_clearHighlight__mQfsZ\",\"highlightCardWrap\":\"HighlightList_highlightCardWrap__AwEUm\",\"highlightCardTitle\":\"HighlightList_highlightCardTitle__VX35G\",\"card\":\"HighlightList_card__d2b2h\",\"hover\":\"HighlightList_hover__VuEbT\"};","// extracted by mini-css-extract-plugin\nexport default {\"searchBar\":\"SearchBar_searchBar__nTkuX\",\"search\":\"SearchBar_search__rUkCI\",\"searchButton\":\"SearchBar_searchButton__kyrsF\",\"searchInput\":\"SearchBar_searchInput__64lOR\"};","import axios from 'axios';\nimport { useEffect } from 'react';\nimport styles from './SearchBar.module.css';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faMagnifyingGlass } from '@fortawesome/free-solid-svg-icons';\n\nfunction SearchBar(props) { \n    function handleSubmit(event) {\n        event.preventDefault();\n    }\n    \n    function handleSearchChange(event) {\n        if (event.target.value === '') {\n            async function getInitialHighlightData() {\n                await axios.get(`https://inkyuoh.shop/highlights/pdfs/${props.pdfIdx}/pages/${props.currentPageNumber}`)\n                    .then((response) => {\n                        console.log('Search highlight data response:', response);\n                        props.setHighlightData(response.data.result)\n                    })\n                    .catch((error) => {\n                        console.log('Search highlight data Fail, error:', error);\n                    })\n            }\n    \n            getInitialHighlightData();\n        } else {\n            async function getHighlightData() {\n                await axios.get(`https://inkyuoh.shop/pdfs/${props.pdfIdx}/highlights/search?keyword=${event.target.value}`)\n                    .then((response) => {\n                        console.log('Search highlight data response:', response);\n                        props.setHighlightData(response.data.result.sort((x, y) => x.pageNum - y.pageNum));\n                    })\n                    .catch((error) => {\n                        console.log('Search highlight data Fail, error:', error);\n                    })\n            }\n            \n            getHighlightData();\n        }\n    }\n    \n    return (\n        <form className={styles.searchBar} onSubmit={(event) => { handleSubmit(event) }}>\n            <button className={styles.searchButton}>\n                <FontAwesomeIcon icon={faMagnifyingGlass} className={styles.searchIcon}></FontAwesomeIcon>\n            </button>\n            <input className={styles.searchInput} type=\"text\" id=\"search\" onChange={handleSearchChange} placeholder={'검색어를 입력해주세요.'}></input>\n        </form>\n    )\n}\n\nexport default SearchBar;","import IconButton from \"@mui/material/IconButton\";\nimport TurnedInIcon from '@mui/icons-material/TurnedIn';\nimport Badge from '@mui/material/Badge';\n\nfunction HighlightBadge(props) {\n    function notificationsLabel(count) {\n        if (count === 0) {\n            return 'no notifications';\n        }\n        \n        if (count > 99) {\n            return 'more than 99 notification';\n        }\n        \n        return `${count} notification`;\n    }\n    \n    return (\n        <IconButton aria-label={notificationsLabel(100)}>\n            <Badge badgeContent={props.highlightDataLength} color='primary'>\n                <TurnedInIcon></TurnedInIcon>\n            </Badge>\n        </IconButton>\n    )\n}\n\nexport default HighlightBadge;","import styles from \"./HighlightList.module.css\";\nimport axios from \"axios\";\nimport { useState, useEffect, useRef } from \"react\";\nimport SearchBar from '../SearchBar/SearchBar.js';\nimport HighlightBadge from './HighlightBadge/HighlightBadge.js';\nimport Card from \"@mui/material/Card\";\nimport CardContent from \"@mui/material/CardContent\";\nimport CardHeader from \"@mui/material/CardHeader\";\nimport Typography from \"@mui/material/Typography\";\nimport Avatar from \"@mui/material/Avatar\";\nimport ClearIcon from \"@mui/icons-material/Clear\";\nimport IconButton from \"@mui/material/IconButton\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faCaretLeft, faCaretRight } from '@fortawesome/free-solid-svg-icons';\n\nfunction HighlightList(props) {\n    const [highlightData, setHighlightData] = useState([]);\n    // console.log(props);\n    useEffect(() => {\n        // if (props.commitIdx === -1) {\n        if (props.readOnly === -1) {\n            async function getHighlightData() {\n                await axios.get(`https://inkyuoh.shop/highlights/pdfs/${props.pdfIdx}/pages/${props.currentPageNumber}`)\n                    .then((response) => {\n                        setHighlightData(response.data.result);\n                    });\n            }\n            \n            getHighlightData(); \n        }\n            \n        // }\n        \n        if (props.readOnly === 1) {\n            async function getHighlightData() {\n                await axios.get(`https://inkyuoh.shop/highlights/pages/${props.currentPageNumber}/commitIdx/${props.commitIdx}`)\n                    .then((response) => {\n                        setHighlightData(response.data.result);\n                    })\n            }\n            \n            getHighlightData();\n        }\n        \n        // else {\n        //     async function getHighlightData() {\n        //         await axios.get(`https://inkyuoh.shop/highlights/pages/${props.currentPageNumber}/commitIdx/${props.commitIdx}`)\n        //             .then((response) => {\n        //                 setHighlightData(response.data.result);\n        //             })\n        //     }\n            \n        //     getHighlightData();\n        // }\n    }, [props.currentPageNumber, props.updateHighlightList, props.commitIdx, props.forceUpdate]);\n\n    return (\n        <>\n            <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                <div className={styles.title}>Highlights</div>\n                {props.mode === false ? <div className={styles.pageNumberInfo}>\n                    <p><input className={styles.pageNumberInput} placeholder={props.currentPageNumber} onKeyUp={(event) => {\n                        event.preventDefault();\n                        if (window.event.keyCode === 13 && 1 <= event.target.value && event.target.value <= props.totalPage) {\n                            props.setCurrentPageNumber(Number(event.target.value));\n                            event.target.value = null;\n                        }\n                    }}></input> / {props.totalPage}</p>\n                </div>\n                : null}\n            </div>\n            <SearchBar pdfIdx={props.pdfIdx} currentPageNumber={props.currentPageNumber} highlightData={highlightData} setHighlightData={setHighlightData}></SearchBar>\n            <div className={styles.highlightInfo}>\n                {/* <p className={styles.pageNumber}>Page {props.currentPageNumber} / {props.totalPage}</p> */}\n                {/* <HighlightBadge></HighlightBadge> */}\n            </div>\n            <aside className={styles.wrap}>\n                <div className={styles.container}>\n                    <HighlightCards\n                        readOnly={props.readOnly}\n                        commitIdx={props.commitIdx}\n                        pdfIdx={props.pdfIdx}\n                        highlightData={highlightData}\n                        setHighlightData={setHighlightData}\n                        style={{ overflow: \"scroll\" }}\n                        updateHighlightList={props.updateHighlightList}\n                        setUpdateHighlightList={props.setUpdateHighlightList}\n                        currentPageNumber={props.currentPageNumber}\n                    ></HighlightCards>\n                </div>\n            </aside>\n        </>\n    );\n}\n\nfunction HighlightCards(props) {\n    function dragStart_handler(event) {\n        event.dataTransfer.setData(\"text/plain\", event.target.innerHTML);\n    }\n\n    async function deleteHighlight(commitIdx, highlightIdx, setHighlightData, updateHighlightList, setUpdateHighlightList, currentPageNumber) {\n        \n        // if (commitIdx === -1) {\n        await axios.delete(`https://inkyuoh.shop/highlights/${highlightIdx}`)\n            .then((response) => {\n                console.log(\"highlight delete response:\", response);\n            })\n            .catch((error) => {\n                console.log(\"highlight delete error:\", error);\n            })\n            .then(async () => {\n                await axios.get(`https://inkyuoh.shop/highlights/pdfs/${props.pdfIdx}/pages/${currentPageNumber}`)\n                    .then((response) => {\n                        setHighlightData(response.data.result);\n                        setUpdateHighlightList(!updateHighlightList);\n                        const selectedHighlight = document.getElementsByClassName('highlight' + highlightIdx);\n                        \n                        for (let i = 0; i < selectedHighlight.length; i++) {\n                            if (selectedHighlight[i].classList.contains('highlightedGreen') === true) {\n                                selectedHighlight[i].classList.remove('highlightedGreen');\n                            }\n                            \n                            if (selectedHighlight[i].classList.contains('highlightedPurple') === true) {\n                                selectedHighlight[i].classList.remove('highlightedPurple');\n                            }\n                            \n                            if (selectedHighlight[i].classList.contains('highlightedYellow') === true) {\n                                selectedHighlight[i].classList.remove('highlightedYellow');\n                            }\n                        }\n                    })\n            })\n        // }\n    }\n\n    return (\n        <>\n            {props.highlightData?.map(function (element, index) {\n                return (\n                    <>\n                        <Card sx={{ width: '100%', minWidth: 275, marginBottom: 1 }} key={index} className={styles.card}>\n                            <CardHeader \n                                sx={{ paddingBottom: 0 }}\n                                avatar={<Avatar sx={{ width: 10, height: 10, bgcolor: element.color === 0 ? '#93E7A2' : element.color === 1 ? '#9747FF' : element.color === 2 ? '#FFD644' : null}} \n                                aria-label=\"recipe\">{\"\"}</Avatar>}\n                                title={'p.' + `${element.pageNum}`}\n                                action={props.readOnly === -1 ?\n                                    <IconButton onClick={() => { deleteHighlight( props.commitIdx, element.highlightIdx, props.setHighlightData, props.updateHighlightList, props.setUpdateHighlightList, props.currentPageNumber ); }}>\n                                        <ClearIcon fontSize=\"small\"></ClearIcon>\n                                    </IconButton>\n                                    : null\n                                }\n                            /><CardContent sx={{ paddingTop: '4px'}}>\n                                <Typography sx={{ fontSize: 14 }} color=\"text.secondary\" draggable={props.readOnly === -1 ? 'true' : null} onDragStart={(event) => { dragStart_handler(event); }}>\n                                    {element.data}\n                                </Typography>\n                            </CardContent>\n                        </Card>\n                    </>\n                );\n            })}\n        </>\n    );\n}\n\nexport default HighlightList;\n","// extracted by mini-css-extract-plugin\nexport default {\"sideBarContents\":\"SideBar_sideBarContents__KmwNy\",\"bookInfo\":\"SideBar_bookInfo__+AGC2\",\"bookImage\":\"SideBar_bookImage__o80DQ\",\"bookTitle\":\"SideBar_bookTitle__4hT75\",\"historyContainer\":\"SideBar_historyContainer__laxyt\",\"historyTitle\":\"SideBar_historyTitle__iYLbi\",\"historyInputWrap\":\"SideBar_historyInputWrap__3aYZ2\",\"historyInput\":\"SideBar_historyInput__3t5Oq\",\"historyWrap\":\"SideBar_historyWrap__Ih9xV\",\"historyUnorderedListTag\":\"SideBar_historyUnorderedListTag__KWQHM\",\"historyMessage\":\"SideBar_historyMessage__kdmFK\",\"historyDateAndIcon\":\"SideBar_historyDateAndIcon__Ihenq\",\"historyDate\":\"SideBar_historyDate__Vax62\",\"historyIcon\":\"SideBar_historyIcon__-+mfK\",\"readOnly\":\"SideBar_readOnly__TgCzT\",\"rollBack\":\"SideBar_rollBack__ETisR\",\"sideBarToggleButton\":\"SideBar_sideBarToggleButton__D3HGR\"};","// mui\nimport { styled } from '@mui/material/styles';\nimport Switch from '@mui/material/Switch';\n\nconst ShowAndHideSwitch = styled((props) => (\n    <Switch focusVisibleClassName=\".Mui-focusVisible\" disableRipple {...props} />\n  ))(({ theme }) => ({\n    width: 42,\n    height: 26,\n    padding: 0,\n    '& .MuiSwitch-switchBase': {\n      padding: 0,\n      margin: 2,\n      transitionDuration: '300ms',\n      '&.Mui-checked': {\n        transform: 'translateX(16px)',\n        color: '#fff',\n        '& + .MuiSwitch-track': {\n          backgroundColor: theme.palette.mode === 'dark' ? '#2ECA45' : '#93E8DE',\n          opacity: 1,\n          border: 0,\n        },\n        '&.Mui-disabled + .MuiSwitch-track': {\n          opacity: 0.5,\n        },\n      },\n      '&.Mui-focusVisible .MuiSwitch-thumb': {\n        color: '#33cf4d',\n        border: '6px solid #fff',\n      },\n      '&.Mui-disabled .MuiSwitch-thumb': {\n        color:\n          theme.palette.mode === 'light'\n            ? theme.palette.grey[100]\n            : theme.palette.grey[600],\n      },\n      '&.Mui-disabled + .MuiSwitch-track': {\n        opacity: theme.palette.mode === 'light' ? 0.7 : 0.3,\n      },\n    },\n    '& .MuiSwitch-thumb': {\n      boxSizing: 'border-box',\n      width: 22,\n      height: 22,\n    },\n    '& .MuiSwitch-track': {\n      borderRadius: 26 / 2,\n      backgroundColor: theme.palette.mode === 'light' ? '#E9E9EA' : '#39393D',\n      opacity: 1,\n      transition: theme.transitions.create(['background-color'], {\n        duration: 500,\n      }),\n    },\n  }));\n  \n  export default ShowAndHideSwitch;","import axios from 'axios';\nimport { useEffect, useState, useRef } from 'react';\nimport styles from './SideBar.module.css'\nimport { faAngleRight, faAngleLeft, faEye, faArrowRotateLeft } from '@fortawesome/free-solid-svg-icons';\nimport dayjs from 'dayjs';\n\n// mui\nimport Stack from '@mui/material/Stack';\nimport Button from '@mui/material/Button';\nimport Snackbar from '@mui/material/Snackbar';\nimport MuiAlert from '@mui/material/Alert';\nimport * as React from 'react';\n\n//fontawesome\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nfunction SideBar(props) {\n\tconst [sideBarStatus, setSideBarStatus] = useState(false);\n\tconst [commitsInfo, setCommitsInfo] = useState([]);\n\tconst commitInput = useRef();\n\tconst date = dayjs();\n\tconst result = date.format('YYYY-MM-DD HH:mm:ss');\n\t\n\tlet userIdx = 58;\n\t\n\tfunction handleSubmit(event) {\n\t\tevent.preventDefault();\n\t\t\n\t\tif (commitInput.current.value !== '') {\t\t\t\n\t\t\taxios.post('https://inkyuoh.shop/commits', {\n\t\t\t\t\tpdfIdx: props.currentBookInfo.pdfIdx,\n\t\t\t\t\tuserIdx: userIdx,\n\t\t\t\t\tcreatedAt: result,\n\t\t\t\t\tcommitMessage: commitInput.current.value\n\t\t\t\t})\n\t\t\t\t.then((response) => {\t\t\t\t\t\n\t\t\t\t\tconsole.log('Commit response:', response);\n\t\t\t\t\taxios.get(`https://inkyuoh.shop/commits/users/${userIdx}/books/${props.currentBookInfo.pdfIdx}`)\n\t\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\t\tconsole.log('Reset commitsInfo response:', response);\n\t\t\t\t\t\t\tsetCommitsInfo(response?.data?.result?.reverse());\n\t\t\t\t\t\t\tsetShowSnackBar(true);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t\tconsole.log('Reset commitsInfo Fail, error:', error);\n\t\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tconsole.log('Commit Fail, error:', error);\n\t\t\t\t})\n\t\t\t\t\n\t\t\tcommitInput.current.value = null;\n\t\t} else {\n\t\t\tsetShowErrorSnackBar(true);\n\t\t}\n\t}\n\t\n\tuseEffect(() => {\n\t\taxios.get(`https://inkyuoh.shop/commits/users/${userIdx}/books/${props.currentBookInfo.pdfIdx}`)\n\t\t\t.then((response) => {\n\t\t\t\tconsole.log(response);\n\t\t\t\tsetCommitsInfo(response?.data?.result?.reverse());\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.log(error);\n\t\t\t})\n\t}, [sideBarStatus])\n\t\n\t// snack bar\n\tconst [showSnackBar, setShowSnackBar] = useState(false);\n\tconst [showErrorSnackBar, setShowErrorSnackBar] = useState(false);\n\t\n    const handleClose = (event, reason) => {\n        if (reason === 'clickaway') {\n            return;\n        }\n        \n        setShowSnackBar(false);\n\t\tsetShowErrorSnackBar(false);\n    }\n    \n    const Alert = React.forwardRef(function Alert(props, ref) {\n        return <MuiAlert elevation={6} ref={ref} variant=\"filled\" {...props}></MuiAlert>\n    })\n\n\treturn (\n\t\t<>\t\n\t\t\t<div className={styles.sideBarContents} style={sideBarStatus === true ? {} : {display: 'none'}}>\n\t\t\t\t<div className={styles.bookInfo}>\n\t\t\t\t\t<div className={styles.bookImage} style={{backgroundImage: \"url(\" + `${process.env.PUBLIC_URL + `${props.currentBookInfo.firstPageLink}`}`}}></div>\n\t\t\t\t\t<p className={styles.bookTitle}>{props.currentBookInfo.pdfName}</p>\n\t\t\t\t</div>\n\t\t\t\t<hr style={{ width: '100%', marginTop: 24, marginBottom: 24, marginLeft: 24, marginRight: 16 }}></hr>\n\t\t\t\t<div className={styles.historyContainer}>\n\t\t\t\t\t<div className={styles.historyTitle}>History</div>\n\t\t\t\t\t<form onSubmit={(event) => { handleSubmit(event)} } className={styles.historyInputWrap}>\n\t\t\t\t\t\t<input ref={commitInput} className={styles.historyInput} placeholder={'기록을 남기세요.'}></input>\n\t\t\t\t\t</form>\n\t\t\t\t\t<div className={styles.historyWrap}>\n\t\t\t\t\t\t<History readOnly={props.readOnly} setReadOnly={props.setReadOnly} forceUpdate={props.forceUpdate} setForceUpdate={props.setForceUpdate} commitIdx={props.commitIdx} setCommitIdx={props.setCommitIdx} commitsInfo={commitsInfo}></History>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<Stack spacing={2} sx={{ width: '100%'}}>\n\t\t\t\t\t<Snackbar open={showSnackBar} autoHideDuration={4500} onClose={handleClose}>\n\t\t\t\t\t\t<Alert onClose={handleClose} severity=\"success\" sx={{width: '100%'}}>\n\t\t\t\t\t\t\t저장이 완료되었습니다.\n\t\t\t\t\t\t</Alert>\n\t\t\t\t\t</Snackbar>\n\t\t\t\t\t<Snackbar open={showErrorSnackBar} autoHideDuration={4500} onClose={handleClose}>\n\t\t\t\t\t\t<Alert onClose={handleClose} severity=\"error\" sx={{width: '100%'}}>\n\t\t\t\t\t\t\t기록 내용을 작성해주시기 바랍니다.\n\t\t\t\t\t\t</Alert>\n\t\t\t\t\t</Snackbar>\n\t\t\t\t</Stack>\n\t\t\t</div>\n\t\t\t<FontAwesomeIcon icon={sideBarStatus === true ? faAngleLeft : faAngleRight} className={styles.sideBarToggleButton} onClick={() => {setSideBarStatus(!sideBarStatus);}}></FontAwesomeIcon>\n\t\t</>\n\t)\n}\n\nfunction History(props) {\n\tfunction rollback(element) {\n\t\tprops.setCommitIdx(element.commitIdx);\n\t\tprops.setReadOnly(-1);\n\t\t\n\t\tasync function postLogs(element) {\n\t\t\tawait axios.post(`https://inkyuoh.shop/commits/rollback`, {\n\t\t\t\tcommitHighlightLog: JSON.parse(element.logs),\n\t\t\t\tuserBookIdx: element.userBookIdx\n\t\t\t})\n\t\t\t.then((response) => {\n\t\t\t\tconsole.log(response);\n\t\t\t\tprops.setForceUpdate(props.forceUpdate + 1);\n\t\t\t})\n\t\t}\n\t\t\n\t\tpostLogs(element);\n\t}\n\t\n\tfunction goToReadOnly(element) {\n\t\tprops.setCommitIdx(element.commitIdx);\n\t\tprops.setReadOnly(1);\n\t\t// props.setForceUpdate(props.forceUpdate + 1);\n\t}\n\t\n\treturn (\n\t\t<>\n\t\t\t{props.commitsInfo?.map(function(element, index) {\n\t\t\t\treturn (\n\t\t\t\t\t<ul className={styles.historyUnorderedListTag} key={index}>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<p className={styles.historyMessage} onClick={() => {\n\t\t\t\t\t\t\t\tgoToReadOnly(element);\n\t\t\t\t\t\t\t}}>{element.commitMessage}</p>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<div className={styles.historyDateAndIcon}>\n\t\t\t\t\t\t\t\t<p className={styles.historyDate} onClick={() => {\n\t\t\t\t\t\t\t\t\tgoToReadOnly(element);\t\n\t\t\t\t\t\t\t\t}}>{element.createdAt.substring(2)}</p>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<div className={styles.historyIcon}>\n\t\t\t\t\t\t\t\t\t<FontAwesomeIcon className={styles.readOnly} icon={faEye} onClick={() => {\n\t\t\t\t\t\t\t\t\t\tgoToReadOnly(element);\n\t\t\t\t\t\t\t\t\t}}></FontAwesomeIcon>\n\t\t\t\t\t\t\t\t\t<FontAwesomeIcon className={styles.rollBack} style={{ marginLeft: '4px'}} icon={faArrowRotateLeft} onClick={() => {\n\t\t\t\t\t\t\t\t\t\trollback(element);\n\t\t\t\t\t\t\t\t\t}}></FontAwesomeIcon>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t)\n\t\t\t})}\n\t\t</>\n\t)\n}\n\nexport default SideBar;","import axios from 'axios';\n\n// PDF Download\nimport html2canvas from 'html2canvas';\nimport jsPDF from 'jspdf';\n\n// Highlighting Logic\nfunction clickHighlight( pdfIdx, currentPageNumber, highlightButtonsWrap, updateHighlightList, setUpdateHighlightList, color, event ) {\n    event?.stopPropagation();\n    const selectedText = window.getSelection().toString().trim();\n    const selectedRange = window.getSelection().getRangeAt(0);\n\n    // 같은 Text를 거꾸로 drag해도 selectedStartContainer와 selectedEndContainer는 동일하다.\n    const selectedStartContainer = window.getSelection().getRangeAt(0).startContainer;\n    const selectedEndContainer = window.getSelection().getRangeAt(0).endContainer;\n    const parentElementOfSelectedStartContainer = selectedStartContainer.parentElement;\n    const parentElementOfSelectedEndContainer = selectedEndContainer.parentElement;\n\n    const offsetOfSelectedStartContainer = selectedRange.startOffset;\n    let indexOfSelectedStartContainer = 0;\n    for ( let i = 0; i < parentElementOfSelectedStartContainer.childNodes.length; i++ ) {\n        if ( parentElementOfSelectedStartContainer.childNodes[i] === selectedStartContainer ) {\n            indexOfSelectedStartContainer = i;\n        }\n    }\n\n    // end는 마지막을 초과해서 포함하는 것 같다.\n    const offsetOfSelectedEndContainer = selectedRange.endOffset;\n    let indexOfSelectedEndContainer = 0;\n\n    for ( let i = 0; i < parentElementOfSelectedEndContainer.childNodes.length; i++) {\n        if ( parentElementOfSelectedEndContainer.childNodes[i] === selectedEndContainer ) {\n            indexOfSelectedEndContainer = i;\n        }\n    }\n    \n    function recur(x, count) {\n        if (x.classList.toString().includes(\"y\") === true) {\n            return x.classList;\n        }\n\n        return recur(x.parentElement, count + 1);\n    }\n\n    let yOfSelectedStartContainer = recur( parentElementOfSelectedStartContainer, 0 )[4];\n    let yOfSelectedEndContainer = recur( parentElementOfSelectedEndContainer, 0 )[4];\n    \n    let highlightColorIndex;\n    \n    if (color === 'highlightedGreen') {\n        highlightColorIndex = 0;\n    }\n    \n    if (color === 'highlightedPurple') {\n        highlightColorIndex = 1;\n    }\n    \n    if (color === 'highlightedYellow') {\n        highlightColorIndex = 2;\n    }\n    \n    const highlightData = {\n        pdfIdx: pdfIdx,\n        pageNum: currentPageNumber,\n        startLine: yOfSelectedStartContainer,\n        startOffset: offsetOfSelectedStartContainer,\n        startNode: indexOfSelectedStartContainer,\n        endLine: yOfSelectedEndContainer,\n        endOffset: offsetOfSelectedEndContainer,\n        endNode: indexOfSelectedEndContainer,\n        data: selectedText,\n        color: highlightColorIndex\n    };\n\n    axios.post(\"https://inkyuoh.shop/highlights\", {\n            pdfIdx: pdfIdx,\n            pageNum: currentPageNumber,\n            startLine: yOfSelectedStartContainer,\n            startOffset: offsetOfSelectedStartContainer,\n            startNode: indexOfSelectedStartContainer,\n            endLine: yOfSelectedEndContainer,\n            endOffset: offsetOfSelectedEndContainer,\n            endNode: indexOfSelectedEndContainer,\n            data: selectedText,\n            color: highlightColorIndex,\n        })\n        .then((response) => {\n            console.log(\"Highlight POST Success\\nresponse:\", response);\n            setUpdateHighlightList(!updateHighlightList);\n        })\n        .catch((error) => {\n            console.log(\"Highlight POST Fail\\nerror:\", error);\n        })\n        .then(() => {\n            axios.get(`https://inkyuoh.shop/highlights/pdfs/${pdfIdx}/pages/${currentPageNumber}`)\n                .then((response) => {\n                    doHighlight(highlightData, response.data.result[response.data.result.length - 1].highlightIdx);\n                })\n        })\n\n    highlightButtonsWrap.current.style.display = \"none\";\n}\n\nfunction doHighlight(highlightData, highlightIdx) {\n    const yOfSelectedStartContainer = highlightData.startLine;\n    const offsetOfSelectedStartContainer = highlightData.startOffset;\n    const indexOfSelectedStartContainer = highlightData.startNode;\n\n    const yOfSelectedEndContainer = highlightData.endLine;\n    const offsetOfSelectedEndContainer = highlightData.endOffset;\n    const indexOfSelectedEndContainer = highlightData.endNode;\n\n    const decimalYOfSelectedStartContainer = parseInt( yOfSelectedStartContainer.slice(1), 16);\n    const decimalYOfSelectedEndContainer = parseInt( yOfSelectedEndContainer.slice(1), 16);\n    \n    let highlightColor;\n    \n    if (highlightData.color === 0) {\n        highlightColor = 'highlightedGreen';\n    }\n    \n    if (highlightData.color === 1) {\n        highlightColor = 'highlightedPurple';\n    }\n    \n    if (highlightData.color === 2) {\n        highlightColor = 'highlightedYellow';\n    }\n    \n    // currentElement를 잘 잡지 못해서 에러가 난다.\n    for ( let i = decimalYOfSelectedStartContainer; i <= decimalYOfSelectedEndContainer; i++) {\n        const currentElement = document.getElementsByClassName( `y${i.toString(16)}`)[0];\n        const newRange = document.createRange();\n\n        const newNode = document.createElement(\"span\");\n        \n        // delete 시 곧바로 삭제할 수 있도록 미리 class를 더해놓음.\n        // 나중에 지울 때 class를 통해 곧바로 노드를 찾아서 highlighted 클래스를 제거하면 됨.\n        \n        newNode.classList.add(highlightColor);\n        newNode.classList.add('highlight' + highlightIdx);\n        if ( decimalYOfSelectedStartContainer === decimalYOfSelectedEndContainer) {\n            newRange.setStart( currentElement?.childNodes[indexOfSelectedStartContainer], offsetOfSelectedStartContainer);\n            newRange.setEnd( currentElement?.childNodes[indexOfSelectedEndContainer], offsetOfSelectedEndContainer);\n\n            drawHighlight(newRange, newNode);\n            return;\n        }\n\n        if (i === decimalYOfSelectedStartContainer) {\n            newRange.setStart( currentElement?.childNodes[indexOfSelectedStartContainer], offsetOfSelectedStartContainer);\n            newRange.setEnd( currentElement?.childNodes[currentElement.childNodes.length - 1], currentElement.childNodes[currentElement.childNodes.length - 1].length);\n        } else if (i === decimalYOfSelectedEndContainer) {\n            newRange.setStart(currentElement?.childNodes[0], 0);\n            newRange.setEnd( currentElement?.childNodes[indexOfSelectedEndContainer], offsetOfSelectedEndContainer);\n        } else {\n            newRange.setStart(currentElement?.childNodes[0], 0);\n            newRange.setEnd( currentElement?.childNodes[currentElement.childNodes.length - 1], currentElement.childNodes[currentElement.childNodes.length - 1].length);\n        }\n\n        drawHighlight(newRange, newNode);\n    }\n}\n\nfunction drawHighlight(range, node) {\n    node.appendChild(range.extractContents());\n    range.insertNode(node);\n}\n\n// Turn over functions\nfunction turnOver(direction, currentPageNumber, setCurrentPageNumber, totalPage) {\n    if (direction === 'back') {\n        if (currentPageNumber === 1) {\n            return;\n        }\n        \n        setCurrentPageNumber((currentPageNumber) => currentPageNumber - 1);\n    }\n    \n    if (direction === 'go') {\n        if(currentPageNumber === totalPage) {\n            return;\n        }\n        \n        setCurrentPageNumber((currentPageNumber) => currentPageNumber + 1);\n    }\n}\n\n// html to pdf V.1\nfunction toPdf(pdfName) {\n    document.querySelector('.editor')?.setAttribute('style', 'overflow: visible !important');\n    document.querySelector('.editor')?.setAttribute('style', 'height: auto !important');\n    \n    html2canvas(document.querySelector('.editor')).then((canvas) => {\n        var imgData = canvas.toDataURL('image/png');\n\n        var imgWidth = 180; \n        var pageHeight = imgWidth * 1.414;  \n        var imgHeight = canvas.height * imgWidth / canvas.width;\n        var heightLeft = imgHeight;\n        var margin = 20;\n\n        var doc = new jsPDF('p', 'mm', 'a4');\n        var position = 0;\n\n        doc.addImage(imgData, 'PNG', margin, position, imgWidth, imgHeight);\n        heightLeft -= pageHeight;\n\n        while (heightLeft >= 0) {\n            position = heightLeft - imgHeight;\n            doc.addPage();\n            doc.addImage(imgData, 'PNG', margin, position, imgWidth, imgHeight);\n            heightLeft -= pageHeight;\n        }\n        doc.save(`${pdfName}.pdf`);\n    })\n    \n    document.querySelector('.editor')?.setAttribute('style', 'overflow: scroll !important');\n    document.querySelector('.editor')?.setAttribute('style', 'height: 100% !important');\n}\n\n// html to pdf V.2\n// function toPdf(pdfName) {\n//     document.querySelector('.editor')?.setAttribute('style', 'overflow: visible !important');\n//     document.querySelector('.editor')?.setAttribute('style', 'height: auto !important');\n//     // document.querySelectorAll('.editor > *').forEach((element) => {\n//     //     element.setAttribute('style', 'margin: 12px;');\n//     // })\n    \n//     // A4 => 297mm x 210mm\n//     let renderedImg = new Array();\n//     let contentWidth = 180;\n//     let padding = 15;\n    \n//     createPdf();\n    \n//     function generateCanvas(i, doc, deferred, currentList) {\n//         let pdfWidth = $(currentList).outerWidth() * 0.2645;\n//         let pdfHeight = $(currentList).outerHeight() * 0.2645;\n//         let heightCalculate = contentWidth * pdfHeight / pdfWidth;\n        \n//         html2canvas(currentList).then(\n//             function (canvas) {\n//                 let img = canvas.toDataURL('image/jpeg', 1.0);\n//                 renderedImg.push({num: i, image: img, height: heightCalculate});\n//                 deferred.resolve();\n//             }\n//         )\n//     }\n    \n//     function createPdf() {\n//         let lists = document.querySelectorAll('.editor > *');\n//         console.log(lists);\n//         let deferreds = [];\n//         let doc = new jsPDF('p', 'mm', 'a4');\n        \n//         for (let i = 0; i < lists.length; i++) {\n//             let deferred = $.Deferred();\n//             deferreds.push(deferred.promise());\n//             generateCanvas(i, doc, deferred, lists[i]);\n//         }\n        \n//         $.when.apply($, deferreds).then(function () {\n//             let sorted = renderedImg.sort(function(a, b) {\n//                 return a.num < b.num ? -1 : 1;\n//             })\n//             let currentHeight = padding;\n            \n//             for (let i = 0; i < sorted.length; i++) {\n//                 let sortedHeight = sorted[i].height;\n//                 let sortedImage = sorted[i].image;\n                \n//                 if ( currentHeight + sortedHeight > 297 - padding * 2) {\n//                     doc.addPage();\n//                     currentHeight = padding;\n//                     doc.addImage(sortedImage, 'jpeg', padding, currentHeight, contentWidth, sortedHeight);\n//                     currentHeight += sortedHeight;\n//                 } else {\n//                     doc.addImage(sortedImage, 'jpeg', padding, currentHeight, contentWidth, sortedHeight);\n//                     currentHeight += sortedHeight;\n//                 }\n//             }\n            \n//             doc.save(`${pdfName}.pdf`);\n            \n//             currentHeight = padding;\n//             renderedImg = new Array();\n//         })\n//     }\n    \n//     document.querySelector('.editor')?.setAttribute('style', 'overflow: scroll !important');\n//     document.querySelector('.editor')?.setAttribute('style', 'height: 100% !important');\n// }\n\nexport { clickHighlight, doHighlight, turnOver, toPdf };","import \"./PersonalReading.css\";\nimport axios from 'axios';\nimport { useState, useEffect, useRef } from \"react\";\nimport { useLocation } from 'react-router-dom';\nimport { useCookies } from 'react-cookie';\nimport $ from 'jquery';\n\n// sideComponents\nimport { WrapperTextEditor } from \"./sideComponents/TextEditor/TextEditor.tsx\";\nimport PageRendered from \"./sideComponents/PageRendered/PageRendered.js\";\nimport HighlightList from \"./sideComponents/HighlightList/HighlightList.js\";\nimport ShowAndHideSwitch from \"./sideComponents/ShowAndHideSwitch/ShowAndHideSwitch.js\";\nimport SideBar from './sideComponents/SideBar/SideBar.js';\n\n// sideFunction for highlighting\nimport { clickHighlight, doHighlight, turnOver, toPdf } from './sideFunction/sideFunction';\n\n// fontawesome\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faCaretLeft, faCaretRight, faFilePdf, faLock } from '@fortawesome/free-solid-svg-icons';\n\n// mui\nimport { CircularProgress } from \"@mui/material\";\n\nfunction PersonalReading(props) {\n    const location = useLocation();\n    const { pdfIdx, recentlyReadPage } = location.state;\n    const [html, setHtml] = useState('');\n    const [updateHighlightList, setUpdateHighlightList] = useState(true);\n    const [commitIdx, setCommitIdx] = useState(-1);\n    const [markdownValue, setMarkdownValue] = useState({});\n    const [highlightData, setHighlightData] = useState([]);\n    const [loading, setLoading] = useState(false);\n    const [forceUpdate, setForceUpdate] = useState(0);\n    const [readOnly, setReadOnly] = useState(-1);\n     \n    const highlightButtonsWrap = useRef();\n    const highlightButton = useRef();\n    const highlightButtonPurple = useRef();\n    const highlightButtonYellow = useRef();\n    const highlightListRef = useRef();\n    const textEditorRef = useRef();\n    \n    // 수정 필요, props로 받아야 할 듯.\n    // library에서 넘어올 때 currentPageNumber를 유저로부터 가져와야 함.\n    // redux?\n    const [currentPageNumber, setCurrentPageNumber] = useState(recentlyReadPage);\n    \n    // library에서 넘어올 때 받아와야 할 듯.\n    // useLocation\n    let userIdx = 58;\n    \n    const [currentBookInfo, setCurrentBookInfo] = useState({});\n    \n    useEffect(() => {\n        axios.get(`https://inkyuoh.shop/users/${userIdx}/pdfs`)\n            .then((response) => {\n                console.log('TotalPage GET response:', response);\n                let newCurrentBookInfo = response.data.result.find(x => x.pdfIdx === pdfIdx);\n                setCurrentBookInfo(newCurrentBookInfo);\n            })\n            .catch((error) => {\n                console.log('TotalPage GET Fail, error:', error);\n            })\n    }, [pdfIdx])\n\n    useEffect(() => {\n        // if (commitIdx === -1) {\n        if (readOnly === -1) {\n            const getPageLink = async () => {\n                const pageLink = await axios.get(`https://inkyuoh.shop/pdfs/${pdfIdx}/pages/${currentPageNumber}`).then((response) => {\n                    return response.data.result.pageLink;\n                });\n                \n                const getHtml = await axios.get(`${pageLink}`).then((response) => {\n                    setHtml(response.data);\n                });\n                \n                const getHighlightData = await axios.get(`https://inkyuoh.shop/highlights/pdfs/${pdfIdx}/pages/${currentPageNumber}`).then((response) => {\n                    setHighlightData(response.data.result);\n                })\n            }\n            \n            getPageLink();\n        }\n        // } else {\n        //     const getPageLink = async () => {\n        //         const pageLink = await axios.get(`https://inkyuoh.shop/pdfs/${pdfIdx}/pages/${currentPageNumber}`).then((response) => {\n        //             return response.data.result.pageLink;\n        //         });\n                \n        //         const getHtml = await axios.get(`${pageLink}`).then((response) => {\n        //             setHtml(response.data);\n        //         });\n                \n        //         const getHighlightData = await axios.get(`https://inkyuoh.shop/highlights/pages/${currentPageNumber}/commitIdx/${commitIdx}`).then((response) => {\n        //             setHighlightData(response.data.result);\n        //         })\n        //     }\n\n        //     getPageLink();\n        // }\n        \n        if (readOnly === 1) {\n            const getPageLink = async () => {\n                const pageLink = await axios.get(`https://inkyuoh.shop/pdfs/${pdfIdx}/pages/${currentPageNumber}`).then((response) => {\n                    return response.data.result.pageLink;\n                });\n                \n                const getHtml = await axios.get(`${pageLink}`).then((response) => {\n                    setHtml(response.data);\n                });\n                \n                const getHighlightData = await axios.get(`https://inkyuoh.shop/highlights/pages/${currentPageNumber}/commitIdx/${commitIdx}`).then((response) => {\n                    setHighlightData(response.data.result);\n                })\n            }\n\n            getPageLink();\n        }\n    }, [currentPageNumber, props.mode, commitIdx, forceUpdate])\n    \n    // Text Editor Value\n    useEffect(() => {\n        setHtml({...html})\n        \n        if (commitIdx !== -1) {\n            axios.post('https://inkyuoh.shop/commits/books/2/2', {\n                    commitIdx: commitIdx\n                })\n                .then((response) => {\n                    return JSON.parse(response.data.result[0].editorLog);\n                })\n                .then((response) => {\n                    console.log('Text Editor markdownValue response:', response);\n                    setMarkdownValue(response);\n                })\n        }\n    }, [commitIdx, forceUpdate])\n    \n    // Draw Highlight\n    useEffect(() => {\n        try {\n            for (let i = 0; i < highlightData.length; i++) {\n                doHighlight(highlightData[i], highlightData[i].highlightIdx);\n            }       \n        }\n        catch {\n            // console.log('hello');\n        }\n    }, [highlightData, commitIdx, forceUpdate, readOnly])\n    \n    useEffect(() => {\n        function selectableTextAreaMouseUp(event) {\n            const highlightButtonCurrent = highlightButtonsWrap.current;\n\n            setTimeout(() => {\n                if (window.getSelection().toString().trim() != 0) {\n                    const x = event.pageX;\n                    const y = event.pageY;\n\n                    const highlightButtonCurrentWidth = Number(getComputedStyle(highlightButtonCurrent).width.slice(0, -2));\n                    const highlightButtonCurrentHeight = Number(getComputedStyle(highlightButtonCurrent).width.slice(0, -2));\n\n                    highlightButtonCurrent.style.left = `${x - highlightButtonCurrentWidth * 0.5}px`;\n                    highlightButtonCurrent.style.top = `${y - highlightButtonCurrentHeight * 1.0}px`;\n                    highlightButtonCurrent.style.display = \"flex\";\n                    highlightButtonCurrent.classList.add(\"btnEntrance\");\n                }\n            }, 0);\n        }\n        \n        const selectableTextArea = document.querySelectorAll(\".PersonalReading__mainPage--readingPage\");\n\n        selectableTextArea?.forEach((element) => {\n            if (readOnly === -1) {\n                element?.addEventListener(\"mouseup\", selectableTextAreaMouseUp);\n                element?.addEventListener('touchend', selectableTextAreaMouseUp, false); \n            }\n        });\n\n        function documentMouseDown(event) {\n            const highlightButtonCurrent = highlightButtonsWrap.current;\n\n            if (highlightButtonCurrent.style.display === \"flex\" && event.target.classList.contains('specific') === false) {\n                \n                highlightButtonCurrent.style.display = \"none\";\n                highlightButtonCurrent.classList.remove(\"btnEntrance\");\n                window.getSelection().empty();\n            }\n        }\n\n        document.addEventListener(\"mousedown\", documentMouseDown);\n        document.addEventListener('touchstart', documentMouseDown, false);\n        \n        // selection height 조정\n        document.querySelectorAll('.c').forEach((element) => {\n            element.style.height = '110%';\n        })\n        \n        document.querySelectorAll('.t').forEach((element) => {\n            element.style.height = '2.1em';\n        })\n\n        return () => {\n            selectableTextArea?.forEach((element) => {\n                element?.removeEventListener(\"mouseup\", selectableTextAreaMouseUp);\n                element?.removeEventListener(\"touchend\", selectableTextAreaMouseUp);\n            });\n            \n            document.removeEventListener(\"mousedown\", documentMouseDown);\n            document.removeEventListener(\"touchstart\", documentMouseDown);\n        };\n    }, [html])\n    \n    useEffect(() => {\n        if (readOnly === 1) {\n            highlightListRef.current.style.opacity = 0.85;\n            textEditorRef.current.style.opacity = 0.7;\n        } else {\n            highlightListRef.current.style.opacity = 1;\n            textEditorRef.current.style.opacity = 1;\n        }\n    }, [readOnly])\n\n    return (\n        <main className=\"PersonalReading\">\n            {readOnly === 1 ? <div className=\"ReadOnlyText\">읽기 전용 상태입니다.&nbsp;&nbsp;&nbsp;<FontAwesomeIcon icon={faLock}></FontAwesomeIcon></div> : null}\n            {loading && <CircularProgress className=\"CircularProgress\"></CircularProgress>}\n            <div ref={highlightButtonsWrap} className=\"HighlightButton__wrap\">\n                <button ref={highlightButton} className=\"HighlightButton specific\"\n                    onTouchStart={(event) => {\n                        clickHighlight(pdfIdx, currentPageNumber, highlightButtonsWrap, updateHighlightList, setUpdateHighlightList, 'highlightedGreen', event); \n                    }}\n                    onClick={() => { clickHighlight(pdfIdx, currentPageNumber, highlightButtonsWrap, updateHighlightList, setUpdateHighlightList, 'highlightedGreen'); }}\n                ></button>\n                \n                <button ref={highlightButtonPurple} className=\"HighlightButton__purple specific\"\n                    onTouchStart={(event) => {\n                        clickHighlight(pdfIdx, currentPageNumber, highlightButtonsWrap, updateHighlightList, setUpdateHighlightList, 'highlightedPurple', event); \n                    }}\n                    onClick={() => { clickHighlight(pdfIdx, currentPageNumber, highlightButtonsWrap, updateHighlightList, setUpdateHighlightList, 'highlightedPurple'); }}\n                ></button>\n                \n                <button ref={highlightButtonYellow} className=\"HighlightButton__yellow specific\"\n                    onTouchStart={(event) => {\n                        clickHighlight(pdfIdx, currentPageNumber, highlightButtonsWrap, updateHighlightList, setUpdateHighlightList, 'highlightedYellow', event); \n                    }}\n                    onClick={() => { clickHighlight(pdfIdx, currentPageNumber, highlightButtonsWrap, updateHighlightList, setUpdateHighlightList, 'highlightedYellow'); }}\n                ></button>\n            </div>\n            \n            <div className=\"PersonalReading__container\" style={loading === true ? {opacity: 0.8} : null}>\n                <aside className=\"PersonalReading__sideBar\">\n                    <SideBar readOnly={readOnly} setReadOnly={setReadOnly} forceUpdate={forceUpdate} setForceUpdate={setForceUpdate} commitIdx={commitIdx} setCommitIdx={setCommitIdx} currentBookInfo={currentBookInfo}></SideBar>\n                </aside>\n                \n                <div className=\"PersonalReading__mainPage\" style={props.mode === true ? {flex: 3} : {flex: 1}}>\n                    {props.mode === true ? <article className=\"PersonalReading__mainPage--readingPage\" style={props.mode === true ? {flex: 2} : {flex: 0}}>\n                        <PageRendered className=\"PageRendered\" html={html}></PageRendered>\n                        <div className=\"PersonalReading__mainPage--goBackButtons\">\n                            <FontAwesomeIcon icon={faCaretLeft} className=\"backButton\" onClick={() => {turnOver('back', currentPageNumber, setCurrentPageNumber, currentBookInfo.totalPage);}}></FontAwesomeIcon>\n                            <FontAwesomeIcon icon={faCaretRight} className=\"goButton\" onClick={() => {turnOver('go', currentPageNumber, setCurrentPageNumber, currentBookInfo.totalPage);}}></FontAwesomeIcon>\n                        </div>\n                        <div className=\"PersonalReading__mainPage--info\">\n                            <p><input className=\"PersonalReading__mainPage--info--input\" placeholder={currentPageNumber} onKeyUp={(event) => {\n                                event.preventDefault();\n                                if (window.event.keyCode === 13 && 1 <= event.target.value && event.target.value <= currentBookInfo.totalPage) {\n                                    setCurrentPageNumber(Number(event.target.value));\n                                    event.target.value = null;\n                                }\n                            }}></input> / {currentBookInfo.totalPage}</p>\n                        </div>\n                    </article> \n                    : null}\n                    <aside ref={highlightListRef} className=\"PersonalReading__highlightList\" style={props.mode === true ? {flex: 1} : {flex: 1}}>\n                        <HighlightList readOnly={readOnly} forceUpdate={forceUpdate} setForceUpdate={setForceUpdate} mode={props.mode} setCurrentPageNumber={setCurrentPageNumber} commitIdx={commitIdx} setCommitIdx={setCommitIdx} pdfIdx={pdfIdx} totalPage={currentBookInfo.totalPage} currentPageNumber={currentPageNumber} updateHighlightList={updateHighlightList} setUpdateHighlightList={setUpdateHighlightList}></HighlightList>\n                        {props.mode === false ?\n                        <div className=\"PersonalReading__highlightList--goBackButtons\">\n                            <FontAwesomeIcon icon={faCaretLeft} className=\"backButton--highlightList\" onClick={() => {turnOver('back', currentPageNumber, setCurrentPageNumber, currentBookInfo.totalPage);}}></FontAwesomeIcon>\n                            <FontAwesomeIcon icon={faCaretRight} className=\"goButton--highlightList\" onClick={() => {turnOver('go', currentPageNumber, setCurrentPageNumber, currentBookInfo.totalPage);}}></FontAwesomeIcon>\n                        </div>\n                        : null}\n                    </aside>\n                </div>\n                \n                <article ref={textEditorRef} className=\"PersonalReading__mainPage--textEditor\" style={props.mode === true ? {flex: 1} : {flex: 1}}>\n                    <div className=\"PersonalReading__mainPage--textEditor--wrap\">\n                        <div className=\"PersonalReading__mainPage--textEditor--info\">\n                            <h1>{currentBookInfo.pdfName}</h1>\n                            <p>{currentBookInfo.author}</p>\n                        </div>\n                        <FontAwesomeIcon className=\"ToPdfButton\" icon={faFilePdf} onClick={() => {\n                            setLoading(true); \n                            setTimeout(() => {\n                                toPdf(currentBookInfo.pdfName, loading, setLoading);\n                                setTimeout(() => {\n                                    setLoading(false);\n                                }, 500);\n                            }, 100);\n                        }}></FontAwesomeIcon>\n                    </div>\n                    <WrapperTextEditor readOnly={readOnly} markdownValue={markdownValue} commitIdx={commitIdx} userIdx={String(userIdx)} pdfIdx={String(pdfIdx)}></WrapperTextEditor>\n                </article>\n            </div>\n        </main>\n    );\n}\n\nexport default PersonalReading;"],"names":["socket","timerId","WrapperTextEditor","props","io","transports","query","String","userIdx","pdfIdx","state","fp","flag","on","once","value","setState","this","readOnly","markdownValue","commitIdx","connected","disconnect","React","updateEditor","userID","pdfID","setTimeout","emit","id","pdfId","text","clearTimeout","updateOrClearEditor","jsonOutput","imageHandler","imageSrc","getPresignedUrl","preSignedUrl","fileName","imageSrcToFile","imageFile","imageUrl","uploadImageToS3","signedUrlPut","randomString","Math","random","toString","substring","axios","response","data","console","log","arr","split","mime","match","bstr","atob","n","length","u8arr","Uint8Array","charCodeAt","File","type","fetch","method","body","headers","TextEditor","useEditor","root","renderReact","Object","keys","editor","Editor","config","ctx","set","rootCtx","defaultValueCtx","get","listenerCtx","updated","doc","prevDoc","toJSON","arrOutput","content","i","j","contentInDoc","contentInDocType","contentAttr","undefined","use","block","tooltip","menu","nord","history","gfm","math","prism","listener","loading","getInstance","useEffect","document","querySelector","setAttribute","height","clientHeight","dangerouslySetInnerHTML","__html","html","className","styles","onSubmit","event","preventDefault","handleSubmit","icon","faMagnifyingGlass","onChange","target","getInitialHighlightData","currentPageNumber","then","setHighlightData","result","catch","error","getHighlightData","sort","x","y","pageNum","placeholder","HighlightCards","highlightIdx","updateHighlightList","setUpdateHighlightList","selectedHighlight","getElementsByClassName","classList","contains","remove","highlightData","map","element","index","Card","sx","width","minWidth","marginBottom","CardHeader","paddingBottom","avatar","Avatar","bgcolor","color","title","action","onClick","deleteHighlight","Clear","fontSize","CardContent","paddingTop","Typography","draggable","onDragStart","dataTransfer","setData","innerHTML","dragStart_handler","useState","forceUpdate","style","display","justifyContent","mode","onKeyUp","window","keyCode","totalPage","setCurrentPageNumber","Number","overflow","styled","Switch","focusVisibleClassName","disableRipple","theme","padding","margin","transitionDuration","transform","backgroundColor","palette","opacity","border","grey","boxSizing","borderRadius","transition","transitions","create","duration","History","goToReadOnly","setCommitIdx","setReadOnly","commitsInfo","commitMessage","createdAt","faEye","marginLeft","faArrowRotateLeft","commitHighlightLog","JSON","parse","logs","userBookIdx","setForceUpdate","postLogs","rollback","sideBarStatus","setSideBarStatus","setCommitsInfo","commitInput","useRef","dayjs","format","currentBookInfo","reverse","showSnackBar","setShowSnackBar","showErrorSnackBar","setShowErrorSnackBar","handleClose","reason","Alert","ref","elevation","variant","backgroundImage","process","firstPageLink","pdfName","marginTop","marginRight","current","Stack","spacing","Snackbar","open","autoHideDuration","onClose","severity","faAngleLeft","faAngleRight","clickHighlight","highlightButtonsWrap","stopPropagation","selectedText","getSelection","trim","selectedRange","getRangeAt","selectedStartContainer","startContainer","selectedEndContainer","endContainer","parentElementOfSelectedStartContainer","parentElement","parentElementOfSelectedEndContainer","offsetOfSelectedStartContainer","startOffset","indexOfSelectedStartContainer","childNodes","offsetOfSelectedEndContainer","endOffset","indexOfSelectedEndContainer","recur","count","includes","highlightColorIndex","yOfSelectedStartContainer","yOfSelectedEndContainer","startLine","startNode","endLine","endNode","doHighlight","highlightColor","decimalYOfSelectedStartContainer","parseInt","slice","decimalYOfSelectedEndContainer","currentElement","newRange","createRange","newNode","createElement","add","setStart","setEnd","drawHighlight","range","node","appendChild","extractContents","insertNode","turnOver","direction","useLocation","recentlyReadPage","setHtml","setMarkdownValue","setLoading","highlightButton","highlightButtonPurple","highlightButtonYellow","highlightListRef","textEditorRef","setCurrentBookInfo","newCurrentBookInfo","find","getPageLink","pageLink","editorLog","selectableTextAreaMouseUp","highlightButtonCurrent","pageX","pageY","highlightButtonCurrentWidth","getComputedStyle","highlightButtonCurrentHeight","left","top","selectableTextArea","querySelectorAll","documentMouseDown","empty","forEach","addEventListener","removeEventListener","faLock","CircularProgress","onTouchStart","flex","faCaretLeft","faCaretRight","author","faFilePdf","html2canvas","canvas","imgData","toDataURL","imgWidth","pageHeight","imgHeight","heightLeft","jsPDF","position","addImage","addPage","save","toPdf"],"sourceRoot":""}